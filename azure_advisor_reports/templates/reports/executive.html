{% extends 'reports/base.html' %}

{% block title %}Executive Summary - Azure Advisor Report - {{ client.company_name }}{% endblock %}

{% block content %}
    <!-- Executive Summary Cards -->
    <div class="summary-stats">
        <div class="stat-card">
            <div class="stat-label">Optimization Opportunities</div>
            <div class="stat-value">{{ summary_metrics.total_recommendations }}</div>
            <div class="stat-subtitle">Actionable recommendations</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Annual Savings Potential</div>
            <div class="stat-value">${{ summary_metrics.total_savings|floatformat:0 }}</div>
            <div class="stat-subtitle">${{ summary_metrics.monthly_savings|floatformat:0 }} per month</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">High Priority Items</div>
            <div class="stat-value text-danger">{{ summary_metrics.high_priority_count }}</div>
            <div class="stat-subtitle">Require immediate attention</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Categories Impacted</div>
            <div class="stat-value">{{ summary_metrics.categories_affected }}</div>
            <div class="stat-subtitle">Azure services affected</div>
        </div>
    </div>

    <!-- Key Insights -->
    <div class="section">
        <h2 class="section-title">Key Insights</h2>

        <div class="success-box">
            <h3 style="margin-bottom: 15px;">ðŸ’¡ Executive Summary</h3>
            <p style="font-size: 1.1em; line-height: 1.8;">
                Azure Advisor has identified <strong>{{ summary_metrics.total_recommendations }} optimization opportunities</strong>
                across your Azure environment. Implementing these recommendations could result in annual cost savings of
                <strong>${{ summary_metrics.total_savings|floatformat:0 }}</strong> while improving security, reliability, and performance.
                <strong>{{ summary_metrics.high_priority_count }} high-priority items</strong> have been flagged for immediate attention.
            </p>
        </div>
    </div>

    <!-- Category Distribution -->
    <div class="section">
        <h2 class="section-title">Recommendations by Category</h2>

        <table class="recommendation-table">
            <thead>
                <tr>
                    <th>Category</th>
                    <th style="text-align: center;">Count</th>
                    <th style="text-align: center;">Percentage</th>
                </tr>
            </thead>
            <tbody>
                {% for cat in category_chart_data %}
                <tr>
                    <td>
                        <span class="badge badge-category" style="background-color: {{ cat.color }};">
                            {{ cat.category }}
                        </span>
                    </td>
                    <td style="text-align: center;"><strong>{{ cat.count }}</strong></td>
                    <td style="text-align: center;">
                        <div style="display: flex; align-items: center; justify-content: center;">
                            <div style="width: 100px; background-color: #e0e0e0; height: 20px; border-radius: 10px; margin-right: 10px;">
                                <div style="width: {{ cat.percentage }}%; background-color: {{ cat.color }}; height: 100%; border-radius: 10px;"></div>
                            </div>
                            <span>{{ cat.percentage }}%</span>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Quick Wins -->
    <div class="section">
        <h2 class="section-title">Quick Wins - Top Priority Actions</h2>

        <div class="warning-box">
            <p><strong>High Impact, High Value:</strong> These {{ quick_wins|length }} recommendations offer the best combination of impact and savings potential.</p>
        </div>

        <table class="recommendation-table">
            <thead>
                <tr>
                    <th>Priority</th>
                    <th>Recommendation</th>
                    <th>Category</th>
                    <th style="text-align: right;">Annual Savings</th>
                </tr>
            </thead>
            <tbody>
                {% for rec in quick_wins %}
                <tr>
                    <td style="text-align: center;">
                        <strong style="font-size: 1.2em; color: var(--primary-color);">#{{ forloop.counter }}</strong>
                    </td>
                    <td>
                        <strong>{{ rec.recommendation|truncatewords:12 }}</strong>
                        {% if rec.resource_name %}
                        <br><small class="text-muted">Resource: {{ rec.resource_name }}</small>
                        {% endif %}
                    </td>
                    <td>
                        <span class="badge badge-{{ rec.category }}">{{ rec.get_category_display }}</span>
                    </td>
                    <td style="text-align: right;">
                        <strong class="text-success" style="font-size: 1.1em;">${{ rec.potential_savings|floatformat:0 }}</strong>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center text-muted">No high-priority recommendations at this time.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Top 10 Recommendations -->
    <div class="section">
        <h2 class="section-title">Top 10 Recommendations by Potential Value</h2>

        <table class="recommendation-table">
            <thead>
                <tr>
                    <th>Impact</th>
                    <th>Category</th>
                    <th>Recommendation</th>
                    <th style="text-align: right;">Potential Savings</th>
                </tr>
            </thead>
            <tbody>
                {% for rec in top_10_recommendations %}
                <tr>
                    <td><span class="badge badge-{{ rec.business_impact }}">{{ rec.get_business_impact_display }}</span></td>
                    <td><span class="badge badge-{{ rec.category }}">{{ rec.get_category_display }}</span></td>
                    <td>
                        <strong>{{ rec.recommendation|truncatewords:15 }}</strong>
                        {% if rec.resource_name %}
                        <br><small class="text-muted">{{ rec.resource_name }}</small>
                        {% endif %}
                    </td>
                    <td style="text-align: right;">
                        {% if rec.potential_savings > 0 %}
                        <strong class="text-success">${{ rec.potential_savings|floatformat:2 }}</strong>
                        {% else %}
                        <span class="text-muted">Non-financial benefit</span>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center text-muted">No recommendations available.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Strategic Recommendations -->
    <div class="section">
        <h2 class="section-title">Strategic Recommendations</h2>

        <div class="info-box">
            <h3 style="margin-bottom: 15px;">Executive Action Items</h3>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <h4 style="color: var(--danger-color); margin-bottom: 10px;">ðŸ”´ Immediate (This Week)</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li>Address {{ high_impact_count }} high-priority items</li>
                        <li>Review security recommendations</li>
                        <li>Assign ownership to technical teams</li>
                    </ul>
                </div>

                <div>
                    <h4 style="color: var(--warning-color); margin-bottom: 10px;">ðŸŸ¡ Short-term (This Month)</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li>Implement quick win optimizations</li>
                        <li>Plan cost reduction initiatives</li>
                        <li>Establish monitoring baselines</li>
                    </ul>
                </div>

                <div>
                    <h4 style="color: var(--success-color); margin-bottom: 10px;">ðŸŸ¢ Long-term (This Quarter)</h4>
                    <ul style="margin-left: 20px; line-height: 2;">
                        <li>Complete all recommendations</li>
                        <li>Optimize architecture patterns</li>
                        <li>Implement continuous optimization</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Financial Impact Summary -->
    <div class="section">
        <h2 class="section-title">Financial Impact Summary</h2>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
            <div style="background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); padding: 30px; border-radius: 8px;">
                <h3 style="color: var(--success-color); margin-bottom: 15px;">Cost Optimization</h3>
                <div style="font-size: 2.5em; font-weight: 300; color: var(--success-color); margin-bottom: 10px;">
                    ${{ total_savings|floatformat:0 }}
                </div>
                <p>Annual savings potential through right-sizing, reserved instances, and resource optimization</p>
            </div>

            <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); padding: 30px; border-radius: 8px;">
                <h3 style="color: var(--info-color); margin-bottom: 15px;">Implementation Effort</h3>
                <div style="font-size: 2.5em; font-weight: 300; color: var(--info-color); margin-bottom: 10px;">
                    ~{% widthratio summary_metrics.total_recommendations 1 8 %}h
                </div>
                <p>Estimated technical effort based on {{ total_recommendations }} recommendations at ~8 hours each</p>
            </div>

            <div style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 100%); padding: 30px; border-radius: 8px;">
                <h3 style="color: var(--warning-color); margin-bottom: 15px;">ROI Projection</h3>
                <div style="font-size: 2.5em; font-weight: 300; color: var(--warning-color); margin-bottom: 10px;">
                    {% widthratio total_savings 1000 100 %}%
                </div>
                <p>Conservative return on investment estimate over 12 months post-implementation</p>
            </div>
        </div>
    </div>
{% endblock %}
